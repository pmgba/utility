if($("#wpTextbox1").keydown(function(a){if(9==a.keyCode){var b=this.selectionStart,c=this.selectionEnd,d=this.scrollTop,e=this.value.substring(b,c);if(e.match(/\n/))e=e.replace(/\n/g,"\n\t");else{e="\t";var f=b+e.length}this.value=this.value.substring(0,b)+e+this.value.substring(c,this.value.length),this.focus(),this.selectionStart=f||b,this.selectionEnd=b+e.length,this.scrollTop=d,a.preventDefault()}}),2==mw.config.get("wgNamespaceNumber")&&mw.config.get("wgRelevantUserName")!=mw.config.get("wgUserName")){var $wpSave=$("#wpSave");$wpSave.prop("disabled",!0);var warning='<div style="margin: 0.5em 0;"><span class="pw-editup__warning" style="font-weight:bold;">这个页面属于另一位用户所有，请在所有者的许可下进行编辑。</span><a class="pw-editup__confirm" href="#" >[我确定]</a></div>';$(".editButtons").after(warning),$(".pw-editup__confirm").click(function(){return $wpSave.prop("disabled",!1),$(this).hide(),!1})}!function(){$("#wpSummaryLabel .mw-summary-preset-item").each(function(){var a=$("<a></a>").attr("href","#").html($(this).html());$(this).html(a)}),$("#wpSummaryLabel .mw-summary-preset-item a").click(function(){var summary=$("#wpSummary").val(),pre=$(this).text();return-1==summary.indexOf(pre)?(summary.length>0&&" "!=summary[summary.length-1]&&(summary+=" "),summary+=pre):summary=summary.replace(eval("/( *)"+pre+"( *)/"),"$1"),$("#wpSummary").val(summary),!1}),$(".mw-summary-preset-item").css({"border-left":"1px solid #aaa",padding:"0 0.5em"}),$(".mw-summary-preset-item:first-child").css({"border-left":"none","padding-left":"0.2em"}),$(".mw-summary-preset-item:last-child").css({"padding-right":"0.2em"})}();var customizeToolbar=function(){$("#wpTextbox1").wikiEditor("removeFromToolbar",{section:"characters"}).wikiEditor("addToToolbar",{sections:{wikicode:{type:"booklet",label:"代码",pages:{tags:{layout:"characters",label:"标签",characters:[{label:"<noinclude></noinclude>",action:{type:"encapsulate",options:{pre:"<noinclude>",post:"</noinclude>"}}},{label:"<includeonly></includeonly>",action:{type:"encapsulate",options:{pre:"<includeonly>",post:"</includeonly>"}}},{label:"<onlyinclude></onlyinclude>",action:{type:"encapsulate",options:{pre:"<onlyinclude>",post:"</onlyinclude>"}}},{label:"<code></code>",action:{type:"encapsulate",options:{pre:"<code>",post:"</code>"}}},{label:"<nowiki></nowiki>",action:{type:"encapsulate",options:{pre:"<nowiki>",post:"</nowiki>"}}}]},magicwords:{layout:"characters",label:"魔术字",characters:["{{PAGENAME}}","{{FULLPAGENAME}}","{{SUBPAGENAME}}","{{TALKPAGENAME}}",,"{{DISPLAYTITLE:}}","{{FULLURL:}}","{{SERVER}}","__TOC__","__NOTOC__","__NOEDITSECTION__","__NEWSECTIONLINK__","__HIDDENCAT__"]},parsers:{layout:"characters",label:"解析函数",characters:["{{#if:}}","{{#ifeq:}}","{{#ifexpr:}}","{{#switch:}}","{{#time:}}"]},others:{layout:"characters",label:"其它",characters:[{label:"[[分类:]]",action:{type:"encapsulate",options:{pre:"[[分类:",post:"]]"}}}]}}},characters2:{type:"booklet",label:"特殊文字",pages:{hiragana:{layout:"characters",label:"平假名",characters:["ぁ","あ","ぃ","い","ぅ","う","ぇ","え","ぉ","お","か","が","き","ぎ","く","ぐ","け","げ","こ","ご","さ","ざ","し","じ","す","ず","せ","ぜ","そ","ぞ","た","だ","ち","ぢ","つ","づ","て","で","と","ど","な","に","ぬ","ね","の","は","ば","ぱ","ひ","び","ぴ","ふ","ぶ","ぷ","へ","べ","ぺ","ほ","ぼ","ぽ","ま","み","む","め","も","ゃ","や","ゅ","ゆ","ょ","よ","ら","り","る","れ","ろ","ゎ","わ","ゐ","ゑ","を","ん","っ","ゔ"]},katagana:{layout:"characters",label:"片假名",characters:["ァ","ア","ィ","イ","ゥ","ウ","ェ","エ","ォ","オ","カ","ガ","キ","ギ","ク","グ","ケ","ゲ","コ","ゴ","サ","ザ","シ","ジ","ス","ズ","セ","ゼ","ソ","ゾ","タ","ダ","チ","ヂ","ツ","ヅ","テ","デ","ト","ド","ナ","ニ","ヌ","ネ","ノ","ハ","バ","パ","ヒ","ビ","ピ","フ","ブ","プ","ヘ","ベ","ペ","ホ","ボ","ポ","マ","ミ","ム","メ","モ","ャ","ヤ","ュ","ユ","ョ","ヨ","ラ","リ","ル","レ","ロ","ヮ","ワ","ヰ","ヱ","ヲ","ン","ヴ","ヵ","ヶ","ヷ","ヸ","ヹ","ヺ","ッ","・","ー"]},greek:{layout:"characters",label:"希腊字母",characters:["Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω"]},pinin:{layout:"characters",label:"汉语拼音",characters:["ā","á","ǎ","à","ō","ó","ǒ","ò","ē","é","ě","è","ī","í","ǐ","ì","ū","ú","ǔ","ù","ǖ","ǘ","ǚ","ǜ","ǜ","ü"]},ipa:{layout:"characters",label:"国际音标",characters:["p","t̪","t","ʈ","c","k","q","ʡ","ʔ","b","d̪","d","ɖ","ɟ","ɡ","ɢ","ɓ","ɗ","ʄ","ɠ","ʛ","t͡s","t͡ʃ","t͡ɕ","d͡z","d͡ʒ","d͡ʑ","ɸ","f","θ","s","ʃ","ʅ","ʆ","ʂ","ɕ","ç","ɧ","x","χ","ħ","ʜ","h","β","v","ʍ","ð","z","ʒ","ʓ","ʐ","ʑ","ʝ","ɣ","ʁ","ʕ","ʖ","ʢ","ɦ","ɬ","ɮ","m","m̩","ɱ","ɱ̩","ɱ̍","n̪","n̪̍","n","n̩","ɳ","ɳ̩","ɲ","ɲ̩","ŋ","ŋ̍","ŋ̩","ɴ","ɴ̩","ʙ","ʙ̩","r","r̩","ʀ","ʀ̩","ɾ","ɽ","ɿ","ɺ","l̪","l̪̩","l","l̩","ɫ","ɫ̩","ɭ","ɭ̩","ʎ","ʎ̩","ʟ","ʟ̩","w","ɥ","ʋ","ɹ","ɻ","j","ɰ","ʘ","ǂ","ǀ","!","ǁ","ʰ","ʱ","ʷ","ʸ","ʲ","ʳ","ⁿ","ˡ","ʴ","ʵ","ˢ","ˣ","ˠ","ʶ","ˤ","ˁ","ˀ","ʼ","i","i̯","ĩ","y","y̯","ỹ","ɪ","ɪ̯","ɪ̃","ʏ","ʏ̯","ʏ̃","ɨ","ɨ̯","ɨ̃","ʉ","ʉ̯","ʉ̃","ɯ","ɯ̯","ɯ̃","u","u̯","ũ","ʊ","ʊ̯","ʊ̃","e","e̯","ẽ","ø","ø̯","ø̃","ɘ","ɘ̯","ɘ̃","ɵ","ɵ̯","ɵ̃","ɤ","ɤ̯","ɤ̃","o","o̯","õ","ɛ","ɛ̯","ɛ̃","œ","œ̯","œ̃","ɜ","ɜ̯","ɜ̃","ə","ə̯","ə̃","ɞ","ɞ̯","ɞ̃","ʌ","ʌ̯","ʌ̃","ɔ","ɔ̯","ɔ̃","æ","æ̯","æ̃","ɶ","ɶ̯","ɶ̃","a","a̯","ã","ɐ","ɐ̯","ɐ̃","ɑ","ɑ̯","ɑ̃","ɒ","ɒ̯","ɒ̃","ˈ","ˌ","ː","ˑ","˘",".","‿","|","‖"]}}},symbols:{type:"booklet",label:"符号",pages:{punc:{layout:"characters",label:"标点符号",characters:["。","，","、","；","：","？","！","…","—","·","ˉ","ˇ","¨","々","～","‖","＂","＇","｀","｜","〃","〈","〉","《","》","「","」","『","』","〖","〗","【","】","（","）","［","］","｛","｝","‘","’","“","”"]},symble:{layout:"characters",label:"特殊符号",characters:["■","◆","▲","●","★","□","◇","△","○","☆","·","§","※","♠","♣","♥","♦","↔","↑","↓","←","→","↖","↗","↘","↙"]},math:{layout:"characters",label:"数学符号",characters:["≈","≡","≠","＝","≤","≥","＜","＞","≮","≯","∷","±","＋","－","×","÷","／","∫","∮","∝","∞","∧","∨","∑","∏","∪","∩","∈","∵","∴","⊥","∥","∠","⌒","⊙","≌","∽","√","℃","°","′","″","＄","￡","￥","‰","％","℃","¤","￠","½","⅓","⅔","¼","¾","⅛","⅜","⅝","⅞","²","m","³",["⌈","⌉"],["⌊","⌋"],"Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩"]}}},tools:{type:"booklet",label:"工具"}}})};mw.util.addCSS(".wikiEditor-ui-toolbar .page-characters div span {box-sizing: content-box !important;font-family: monospace;}"),mw.loader.using("user.options",function(){1==mw.user.options.get("usebetatoolbar")&&$.when(mw.loader.using("ext.wikiEditor.toolbar"),$.ready).then(customizeToolbar)}),function(){function a(){j&&0!==k.val().trim().length&&(i=!0,$(".pw-autosave__savenow").show(),f=30,e=setInterval(c,1e3))}function b(){$(".pw-autosave__savenow").hide(),clearInterval(e),i=!1}function c(){f-=1,$(".pw-autosave__countdown").html(f+"秒后自动保存。"),f<=0&&d()}function d(){j&&(l=k.val(),pw.autosave.draftList[g]={time:mw.now(),length:l.length},pw.localStorage.set(h,l),pw.localStorage.set(pw.autosave.listKey,pw.autosave.draftList),$(".pw-autosave__countdown").html("已保存草稿。"),b(),j=!1)}var e,f=-1,g=mw.config.get("wgPageName"),h=pw.autosave.getDraftKey(g),i=!1,j=!1,k=$("#wpTextbox1");k.change(function(){j=!0,i||a()});var l=pw.localStorage.get(h);null!=l&&$(".pw-autosave__load").show(),$("input#wpSave, input#wpPreview, input#wpDiff").click(function(){d()}),pw.loader.using("font-awesome",function(){var a=pw.util.createMsgBox('<i class="fa fa-fw fa-save"></i>','<div>自动保存功能已经启动，每30秒会自动将您未发布的文章保存至本地浏览器。</div><div style="font-size:small;">\n<a class="pw-autosave__load" href="#">[载入草稿]</a>\n<a class="pw-autosave__savenow" href="#">[马上保存]</a>\n<span class="pw-autosave__countdown"></span></div>',"pw-autosave");$(".editOptions").after(a),$(".pw-autosave__savenow").hide(),$(".pw-autosave__load").toggle(null!=l),$(".pw-autosave__load").click(function(){return $(".pw-autosave__countdown").html("已载入草稿。"),j=!1,b(),k.val(l),!1}),$(".pw-autosave__savenow").click(function(){return d(),!1})})}();