pokeWiki.loader.using(["pokemon.js","pokemon.7.js"],function(){function a(a,b,c,d,e){if(0==a)return 0;if(0==b)return 0;if(1==b)return 1;a=parseInt(a),b=parseInt(b),c=parseInt(c),d=parseInt(d);var f;return 0==e?f=Math.floor((2*b+d+Math.floor(c/4))*a/100+10+a):(f=Math.floor((2*b+d+Math.floor(c/4))*a/100+5),f=Math.floor(f*e)),f}function b(){var a="http://www.pokemon.name/w/index.php?title="+mw.config.get("wgPageName");$("#pokemon")[0].selectedIndex>0&&(a+="&pid="+$("#pokemon")[0].selectedIndex),100!=l.val()&&(a+="&plv="+l.val());for(var b="",c=0;c<=5;c++)b+=","+j[c].value;",31,31,31,31,31,31"!=b&&(a+="&piv="+b.substring(1));for(var d="",c=0;c<=5;c++)d+=","+i[c].value;",0,0,0,0,0,0"!=d&&(a+="&pev="+d.substring(1));for(var e=0,f=0,c=0;c<=4&&(!m[c].checked||!n[c].checked);c++)m[c].checked&&(e=c+1),n[c].checked&&(f=c+1);e+f>0&&(a+="&pn="+e+","+f),$("#URL").val(a)}var c=["red","blue","yellow","green","black","brown","purple","gray","white","pink"],d="";for(d+='<table class="colortable pokemoncolor" id="calc" style="text-align:center;width:560px">',d+='<tr><th style="width:200px">精灵</td><th style="width:50px">能力</td><th>种族值</td><th>个体值</td><th>努力值</td><th>性格</td><th style="width:50px">能力值</td></tr>',q=0;q<=5;q++)d+="<tr>",0==q&&(d+='<td id="Sprite" rowspan="6">&nbsp;</td>'),d+="<td>"+["HP","攻击","防御","特攻","特防","速度"][q]+"</td>",d+='<td class="input"><input type="text" class="BS" value="0" maxlength="3" onkeyup="CalcSingle('+q+');"></td>',d+='<td class="input"><input type="text" class="IV" value="31" maxlength="3" onkeyup="CalcSingle('+q+');"></td>',d+='<td class="input"><input type="text" class="EV" value="0" maxlength="3" onkeyup="CalcSingle('+q+');ChangeEVs();"></td>',d+=0==q?'<td style="font-size:90%">＋　－</td>':'<td><input type="radio" class="Nature1" name="NatureP" onclick="CalcAll();" value="'+(q-1)+'"><input type="radio" class="Nature2" name="NatureM" onclick="CalcAll();" value="'+(q-1)+'"></td>',d+='<td class="Stat">&nbsp;</td></tr>';d+='<tr><td class="select">',d+='<select id="pokemon" onChange="SelectPokemon(value)" style="width:120px">',d+="</select>",d+='<select id="form" onChange="SelectForm(value)" style="width:70px"></select>',d+="</td>",d+='<td>等级</td><td class="input"><input type="text" id="LV" value="100" maxlength="3" onkeyup="CalcAll();"></td>',d+='<td class="select"><select onChange="SelectIVs(value)"><option value=31 selected>全31</option><option value=0 >全0</option></select></td>',d+='<td class="select"><select onChange="SelectEVs(value)">',d+='<option value="0/0/0/0/0/0" selected>全0</option>',d+='<option value="252/0/0/0/0/252">HPSP</option>',d+='<option value="0/252/0/0/0/252">ATSP</option>',d+='<option value="0/0/0/252/0/252">SASP</option>',d+='<option value="252/0/252/0/0/0">HPDF</option>',d+='<option value="252/0/0/0/252/0">HPSD</option>',d+='<option value="0/0/252/0/252/0">DFSD</option>',d+='<option value="252/252/252/252/252/252">全满</option>',d+="</select></td>",d+='<td class="select"><select onChange="SelectNature(value)">';var e=["0/0","0/0","0/1","0/2","0/3","0/4","0/0","1/0","1/1","1/2","1/3","1/4","0/0","2/0","2/1","2/2","2/3","2/4","0/0","3/0","3/1","3/2","3/3","3/4","0/0","4/0","4/1","4/2","4/3","4/4"],f=["----","努力","寂寞","固执","顽皮","勇敢","----","大胆","坦率","淘气","无虑","悠闲","----","谨慎","温和","腼腆","马虎","冷静","----","安静","温顺","慎重","浮躁","傲慢","----","胆小","急躁","开朗","天真","认真"];for(q=0;q<e.length;q++)d+='<option value="'+e[q]+'">'+f[q]+"</option>";d+="</select></td><td>&nbsp;</td></tr>",d+='<tr><td colspan="7"><input type="text" id="URL" style="width:540px;text-align:left" onfocus="$(this).select();" ></td></tr>',d+='<tr><th colspan="7" style="font-size:88%;line-height:14px;font-weight:normal"><span id="msg" style="float:left"></span><span id="msg_ev" style="float:right"></span></th></tr>',d+="</table>",$(".pw-jscontent").html(d);var g=!1,h=$("input.BS"),i=$("input.EV"),j=$("input.IV"),k=$("td.Stat"),l=$("input#LV"),m=document.getElementsByName("NatureP"),n=document.getElementsByName("NatureM"),o={};for(q=0;q<=pw.util.getInfo("maxPokemonCount");q++)o[String("00").concat(q).slice(-3)]=0;if($.each(pw.database.pokemon.data[7],function(a,b){var c=a.split(".");o[c[0]]+=1}),window.SelectGen=function(a){a=parseInt(a);var b=pw.util.getInfo("maxPokemonCounts"),c=b[a-1]+1,d=b[a];0==a&&(c=1,d=pw.util.getInfo("maxPokemonCount"));var e="<option value=0 selected></option>";for(q=c;q<=d;q++)e+="<option value="+q+" >"+String("00").concat(q).slice(-3)+" "+pw.util.getPokemonName(q)+"</option>";$("#pokemon").empty().html(e),SelectPokemon(0)},window.SelectPokemon=function(a){if($("#form").empty(),0==a)$("#Sprite").html("&nbsp;");else{var b=String("00").concat(a).slice(-3),d="";for(q=0;q<o[b];q++){var e=b+"."+String("00").concat(q).slice(-2),f=pw.util.getPokemonName(e);d+="<option value="+e+" >"+(f[1].length>0?f[1]:f[0])+"</option>"}$("#form").html(d),SelectForm(b.concat(".00"));var g=pw.database.pokemon.colors[a];$("#calc").attr("class","colortable pokemoncolor pokemoncolor-"+c[g])}},window.SelectForm=function(a){var b=parseInt(a.split(".")[0]);$("#Sprite").html('<a href="/wiki/'+pw.util.getPokemonName(b)+'" title="'+pw.util.getPokemonName(b)+'">'+pw.util.createPokemonImage("pgl",a,"width:80%;")+"</a>");var c=pw.util.rearrangeBaseStats(pw.database.pokemon.data[7][a].b);for(q=0;q<=5;q++)h[q].value=c[q];CalcAll()},SelectGen(0),window.SelectIVs=function(a){j.val(a),CalcAll()},window.SelectEVs=function(a){var b=a.split("/");for(q=0;q<=5;q++)i[q].value=b[q];CalcAll(),ChangeEVs()},window.ChangeEVs=function(){for(var a=0,b=0;b<=5;b++)a+=parseInt(i[b].value);0==a?$("#msg_ev").html(""):a<508?$("#msg_ev").html("努力值总和"+a+"，剩余"+(510-a)):a>510?$("#msg_ev").html("努力值总和"+a+"，超出"+(a-510)):$("#msg_ev").html("努力值总和"+a)},window.SelectNature=function(a){var b=a.split("/");if(b[0]==b[1])for(q=0;q<=4;q++)m[q].checked=!1,n[q].checked=!1;else m[b[0]].checked=!0,n[b[1]].checked=!0;CalcAll()},window.CalcAll=function(){g=!0;for(var a=0;a<=5;a++)CalcSingle(a);g=!1,b()},window.CalcSingle=function(c){for(var d=[1,1,1,1,1],e=0;e<=4&&(!m[e].checked||!n[e].checked);e++)m[e].checked&&(d[e]=1.1),n[e].checked&&(d[e]=.9);k[c].innerHTML=a(l.val(),h[c].value,i[c].value,j[c].value,0==c?0:d[c-1]),g||b()},window.location.href.indexOf("/w/")>1){for(var p=window.location.href.substring(window.location.href.indexOf("?")+1).split("&"),q=0;q<p.length;q++){var r=p[q].split("=");switch(r[0]){case"pid":$("#pokemon")[0].selectedIndex=r[1];break;case"plv":l.val(r[1]);break;case"piv":for(var s=r[1].split(","),t=0;t<=5;t++)j[t].value=s[t];break;case"pev":for(var u=r[1].split(","),t=0;t<=5;t++)i[t].value=u[t];ChangeEVs();break;case"pn":var v=r[1].split(",");v[0]>0&&(m[v[0]-1].checked=!0),v[1]>0&&(n[v[1]-1].checked=!0)}}$("#pokemon")[0].selectedIndex>0?SelectPokemon($("#pokemon")[0].selectedIndex):CalcAll()}$("#msg").html("装载完毕")});